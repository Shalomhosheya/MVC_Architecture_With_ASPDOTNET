@{
ViewData["Title"] = "Register User";
}

<div style="max-width: 400px; margin: 50px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px;">
    <h2>Register User</h2>

    <div id="message" style="display:none; padding: 10px; margin-bottom: 15px; border-radius: 4px;"></div>

    <div style="margin-bottom: 15px;">
        <label>Email:</label><br>
        <input type="email" id="exampleInputEmail1" placeholder="Enter email" style="width: 100%; padding: 8px;">
    </div>

    <div style="margin-bottom: 15px;">
        <label>Password:</label><br>
        <input type="password" id="exampleInputPassword1" placeholder="Enter password" style="width: 100%; padding: 8px;">
    </div>

    <button id="submitBtn" style="width: 100%; padding: 10px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Submit</button>
</div>

<script>
    console.log("Register page loaded successfully!");

    const email = document.getElementById("exampleInputEmail1");
    const password = document.getElementById("exampleInputPassword1");
    const button = document.getElementById("submitBtn");
    const messageDiv = document.getElementById("message");

    button.addEventListener("click", async function (event) {
        event.preventDefault();

        // Simple validation
        if (!email.value || !password.value) {
            showMessage("Please fill in all fields", "error");
            return;
        }

        const data = {
            email: email.value,
            password: password.value
        };

        try {
            const response = await fetch('/User/SaveUser', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            });

            if (response.ok) {
                const result = await response.json();
                console.log(result.message);
                showMessage(result.message, "success");

                // Clear form
                email.value = "";
                password.value = "";
            } else {
                showMessage("Error saving user", "error");
            }
        } catch (error) {
            console.error("Error:", error);
            showMessage("Network error occurred", "error");
        }
    });

    function showMessage(text, type) {
        messageDiv.textContent = text;
        messageDiv.style.display = "block";
        messageDiv.style.backgroundColor = type === "success" ? "#d4edda" : "#f8d7da";
        messageDiv.style.color = type === "success" ? "#155724" : "#721c24";
        messageDiv.style.border = type === "success" ? "1px solid #c3e6cb" : "1px solid #f5c6cb";
    }
</script>